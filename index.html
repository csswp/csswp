<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Latest SPC Day 1 Forecast</title>
</head>
<body>
    <h1>Latest SPC Day 1 Forecast</h1>
    <pre id="forecast"></pre>

    <script>
        // Make request to fetch latest SPC Day 1 forecast
        fetch('https://api.weather.gov/products/types/outlook')
            .then(response => response.json())
            .then(data => {
                console.log('API Response:', data);

                // Check if the data is an object and has a '@graph' property
                if (typeof data === 'object' && data.hasOwnProperty('@graph')) {
                    // Find the latest Day 1 outlook product
                    const outlookProducts = data['@graph'];
                    let day1Outlook = null;
                    for (const product of outlookProducts) {
                        console.log('Product:', product);
                        if (product.hasOwnProperty('@type') && product.hasOwnProperty('@id')) {
                            if (product['@type'] === 'wx:Outlook' && product['@id'].includes('day1')) {
                                day1Outlook = product;
                                break;
                            }
                        }
                    }
                    console.log('Day 1 Outlook:', day1Outlook);
                    if (day1Outlook) {
                        // Fetch the Day 1 outlook data
                        fetch(day1Outlook['@id'])
                            .then(response => response.json())
                            .then(day1Data => {
                                console.log('Day 1 Data:', day1Data);

                                // Extract and display the forecast
                                const outlookData = day1Data.product.outlook;
                                const forecastPre = document.getElementById('forecast');
                                forecastPre.textContent = JSON.stringify(outlookData, null, 2);
                            })
                            .catch(error => {
                                console.error('Error fetching Day 1 outlook:', error);
                                document.getElementById('forecast').textContent = 'Error fetching Day 1 outlook';
                            });
                    } else {
                        console.error('Day 1 outlook not found.');
                        document.getElementById('forecast').textContent = 'Day 1 outlook not found';
                    }
                } else {
                    console.error('Invalid response format:', data);
                    document.getElementById('forecast').textContent = 'Invalid response format';
                }
            })
            .catch(error => {
                console.error('Error fetching outlook products:', error);
                document.getElementById('forecast').textContent = 'Error fetching outlook products';
            });
    </script>
</body>
</html>
